---
layout: post
title: "4_CNN_3.for convNets"
subtitle: "4_CNN_3.for convNets"
categories: data
tags: deeplearningai
comments: true
---



# 3.ConvNets 을 위한 실질적인 조언들

## 오픈소스를 활용해라

(C4W2L08 Using Open Source Implementation)

- git hub을 잘 써라

## transfer learning, freeze

- 컴퓨터 비전 프로그램을 구성할 때 무작위한 초기화 과정으로 시작하는 대신...
- 다른 사람들이 훈련 시켜 높은 구조를 다운 받는 것이 효과적
- 미리 훈련된 모델로 풀고자 하는 문제의 초기값으로 사용할 수 있음
- 즉 **전이 학습을 통해 공유되는 지식을 전달하는 것**
- 오픈소스에서 model 과 모델에 적용된 weight을 같이 받아
- 풀고자하는 문제의 데이터가 적을 경우 → **최종 분류층인 softmax층을 제거하고 → 문제에 맞게 분류층을 설정 ( class가 3개면 3개를 출력해주는 softmax)**
- 그리고 **모델의 나머지 부분은 학습되지 않게 freeze 시키고 최종층만 훈련**
- **데이터가 많을수록 → 동결층은 줄고 → 훈련시킬 층은 는다**

## Data Augmentation  C4W2L10

![](_2019-07-24__3-e5b8ecfc-1317-4334-ac55-22f2c3f48403.56.47.png)

- mirroing
- Random cropping 위 두개가 많이 쓰이고
- 이론 적으로는 rotation, shearing, local warping 모두 사용된다지만 실질적으로 많이 쓰지 않음

![](_2019-07-24__4-2a84365d-4c3d-4d0f-9b3b-a07f461e12d0.02.32.png)

- colort shifting (이미지의 RGB 채널에 각각 다른 수를 더해주는 방식입니다.)
- -이 방법이 가능한 이유는 햇빛의 변화에도 해당 타겟의 정체성 정보는 손실되지 않기 때문입니다
- 예에서는 큰 변화를 줫는데 실제로는 작은 변화를 준다
- 색변형을할때 pca를 쓴다 .. 종종 pca color agumentation이라고 한다
- 만약 이미지의 주 색이 보라색이라면 → 빨강과 파랑이 주이고, 초록색이 조금이라면 → 초록색에는 상대적으로 적게 주면서 → 전체적인 색조를 유지하게 해준다 ( advanced)

![](_2019-07-24__4-70668b5e-9af6-417a-b23e-541288c33792.05.58.png)

- 데이터의 변형 구현은 주로 cpu 스레드를 통해서 데이터를 불러옴과 동시에 변형을 시켜 배치를 형성합니다.
- 데이터 아규멘테이션을 구현 하는 방법 :
- 이런 하나의 쓰레드나 or 여러개의 쓰레드로 데이터를 불러오고 → 변형을 구현 → 그것을 다른 쓰레드나 프로세스에 전달하고 → 학습 실행 (이것과 이것은 동시에 실행이 가능함)

## C4W2L11 State of Computer Vision

- 데이터가 적으면 수작업 설계가 많아지고 → ' 핵이 많아진다' → 데이터가 적다면 직접 설계하는 것이 가장 최고의 성능
- 컴퓨터 비전에서 네트워크의 성능을 높이려는게 데이터의 부족이기 때문에 (매우 까다롭고, 영감이 많이 필요)
- 물체인식은 이미지 인식 분야보다 더 적은 데이터를 갖고 있음
- 데이터가 적을떄 도움되는 것이 transfer learning

### tip for doing well on benchmarks/ winning coppetition

![](_2019-07-24__4-0e0cb102-395c-47af-b469-d6908c07654e.23.26.png)

- 1.앙상블: 3개나 5개나 신경망을 무작위로 초기화 시키고 그것들의 평균 값 에측값들의 평균값을 냄
- 그러나 시간이 오래 걸린다는 단점(여러개의 네트워크를 유지해야함→ 시간 오래걸려)
- 2.multi crop at test time : 다중 크로핑 역시 테스트 이미지에 적용되는 데이터 아규멘테이션의 한 형태
- 두개의 대칭버전으로 4개의 고양이
- 다중 크로핑은 하나으 ㅣ네트웤만 유지해도 괜찮지만 여전히 오래걸림
- 10 크로핑이라는게 있는데 첫번째 사진에서 가운데를 자르고 → 나머지 4개의 모서리를 잘라 → 이것을 모두 더하면 10개의 이미지 → 그리고 이 10개의 이미지를 분류기에 실행하고 평균을 내준다 → 만약 계싼에 여유가 ㅇ벗으면 10개를 안해도 괜찮고 더 적게해도 괜찮음(더 좋은 성능이 나올 수 있음) → 하지만 이 방법도 실제 제품보다는 벤치마킹에 더 많이 사용

![](_2019-07-24__4-d9716e62-0c4a-4f93-8545-b74d7d41250c.24.31.png)

- 남들 거 쓰기를 추천한다 뭐 대충 이런 말

[https://imgur.com/Ztgyyjh](https://imgur.com/Ztgyyjh)
