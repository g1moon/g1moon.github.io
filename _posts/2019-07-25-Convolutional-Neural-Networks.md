---
layout: post
title:  "4.CNN_1.CNN"
subtitle:   "4.CNN_1.CNN"
categories: data
tags: deeplearningai
comments: true
---

# 1.합성곱 신경망

# 합성곱 신경망 (Convolutional Neural Networks)

## stride

- 따라서 최종 크기는 \displaystyle(\frac{n+2p-f}{s} + 1) \times (\frac{n+2p-f}{s} + 1) (​*s*​​*n*+2*p*−*f*​​+1)×(​*s*​​*n*+2*p*−*f*​​+1) 가 됩니다. 만약에 소수점으로 만들었다면 내림을 하게 됩니다. 보통은 필터에 맞춰서 최대한 크기가 정수가 될수 있도록 패딩과 스트라이드 수치를 맞춥니다.

    ![](_2019-07-23__1-f0ff8765-9b8b-4cfe-8f91-c58100f635b9.30.41.png)

- 필터가 튀어나오면 계산 안해주는 것이 관습

- 위 식이 정수가 아니라면 내림을 해준다 ..  (z가 정수가 아니라면 floor(z))
- 위 값을 정수로 맞춰주기위해 값들을 정하는 것도 좋지만, 아니라면 그냥 내림해줌
- 일반저긍로 수학에서는 합성곱하기전에 '미러링을 해줌' (행과 열을 바꿔서 곱함)
- 그런데 딥러닝에서는 미러링을 생략함, - 신호처리에 유용하지만 딥러닝에는 별 영향을 주지않음

    ![](_2019-07-23__1-a2142dd9-3ae8-40f5-8b12-54c72103dd3f.35.23.png)

## 입체형 이미지에서의 합성곱

(height, width, ch) 채널은 피렅의 채널과 같아야함 

![](_2019-07-23__1-3ef4db54-9a68-4d15-b8ca-687ceaa159a4.52.46.png)

- 빨간색 채널의 세로 윤곽선을 검출하기 위해 초록,파랑은 모두 0으로 두고

    ![](_2019-07-23__1-3c5e7402-dfdd-412f-bee2-111fa375ca21.53.53.png)

    이렇게하면 모든색 세로 선

    ![](_2019-07-23__1-1726ec04-cce3-46a6-8325-c70320247e64.58.20.png)

    - 노란색은 세로, 오랜지는 가로선을 검출기
    - 각각의 필터는 4x4의 필터를 아웃풋으로 갖고, 이 두개의 결과 값 2d 필터를 합쳐
    - → 4x4x2로 만들어 3d모형의 필터로 만들 수 있음
    - 그래서 요약하자면 위 사진 아래의 결과 값으로 나고오고
    - nc'= 필터의 수 를 의미한다 → 그래서 4x4x2 가 나왔고 n-f+1 의 식은 만약
    - 패딩과 스트라이드가 있다면 이 전의 식처럼 바뀌게 될 것 →
    - {(n+2p-f /s) + 1} * {(n+2p-f /s) + 1} * (nc')
    - 6x6x3 에서 채널은 마지막 크기를 나타내고 3d 입체형의 깊이라고도 함
    - 중요한 것은 위처럼 필터의 채널은 검출하고자 하는 특성의 수이며 (예에서는 가로세로2개)
    - 1개의 특성만이 아닌 여러개 수백개의 특성도 검출 할 수 있다는 것이 중요

    ## 합성곱 네트워크의 한 계층 구성하기

    (C4W1L07 One Layer of a Convolutional Net)

    - 신경망을 만들기위해서는 필터에 bias를 더해준다.(이 값은 실수여야 하고 브로드캐스팅해서 4x4면 16개 더해짐)
    - 그리고 모두 더해준 뒤 relu 비선형성을 적용 → '또 다른 4x4' 의 결과를 얻음
